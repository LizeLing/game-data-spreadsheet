# 구현 계획 - 미완성 기능

**작성일**: 2025-10-06
**상태**: 📋 Planning

---

## 📊 현재 상태 요약

### ✅ 완료된 기능 (최신)
- **D1**: 찾기/바꾸기 기능 (17개 테스트 통과)
- **D2**: 셀 복사/붙여넣기 (29개 테스트 통과)
- **D2.5**: 컬럼 이름 변경 (6개 테스트 통과)
- **E1**: Store 테스트 수정 (22개 테스트 통과)

### 📈 전체 테스트 현황
- **단위 테스트**: 134/134 통과 (100%) ✅
- **빌드**: 성공 ✅
- **타입 체크**: 오류 없음 ✅

---

## 🎯 미구현 기능 목록

### **우선순위 1: 핵심 UI 기능**

#### 1. 데이터 검증 UI (D4)
**현재 상태**: Hook만 구현됨, UI 없음

**필요 작업**:
- [ ] `ValidationPanel.tsx` 컴포넌트 생성
  - 실시간 검증 결과 표시
  - 오류/경고 아이콘 표시
  - 오류 메시지 툴팁
  - 검증 규칙 설정 UI

- [ ] Toolbar에 "검증" 버튼 추가
  - 시트 전체 검증 실행
  - 검증 결과 다이얼로그 표시

- [ ] SpreadsheetGrid에 셀 검증 표시
  - 빨간 테두리 (오류)
  - 노란 테두리 (경고)
  - 툴팁으로 메시지 표시

- [ ] 검증 규칙 관리 UI
  - 컬럼별 검증 규칙 설정
  - Zod 스키마 선택
  - 커스텀 규칙 추가

**예상 소요 시간**: 4-6시간

---

#### 2. 셀 병합(Merge) 기능 (D3)
**현재 상태**: 미구현

**필요 작업**:
- [ ] Store에 `mergeCells` 메서드 추가
  - 선택 범위의 셀 병합
  - 병합된 셀 상태 관리
  - 히스토리 추가 (Undo/Redo)

- [ ] Store에 `unmergeCells` 메서드 추가
  - 병합 해제
  - 원본 값 복원

- [ ] Toolbar에 "병합" 버튼 추가
  - 선택 영역 병합
  - 병합 해제

- [ ] AG Grid에 병합 셀 렌더링
  - `colSpan`, `rowSpan` 처리
  - 스타일 적용

- [ ] 테스트 작성
  - 병합/해제 테스트
  - Undo/Redo 테스트
  - 엣지 케이스 테스트

**기술적 과제**:
- AG Grid는 기본적으로 셀 병합을 지원하지 않음
- Custom Cell Renderer로 구현 필요
- 복잡도: 중-상

**예상 소요 시간**: 6-8시간

---

### **우선순위 2: 테스트 완성**

#### 3. SpreadsheetGrid 컴포넌트 테스트 (E2)
**현재 상태**: 테스트 파일 없음

**필요 작업**:
- [ ] `SpreadsheetGrid.test.tsx` 생성
  - 기본 렌더링 테스트
  - 셀 편집 테스트
  - 키보드 단축키 테스트 (Ctrl+C/V/X)
  - 선택 영역 변경 테스트
  - 컬럼 헤더 편집 테스트

- [ ] Mock 데이터 준비
  - 다양한 셀 타입
  - 스타일이 적용된 셀
  - 수식이 있는 셀

**예상 소요 시간**: 3-4시간

---

#### 4. Sidebar 컴포넌트 테스트 (E3)
**현재 상태**: 테스트 파일 없음

**필요 작업**:
- [ ] `Sidebar.test.tsx` 생성
  - 시트 목록 렌더링 테스트
  - 시트 추가 테스트
  - 시트 삭제 테스트
  - 시트 선택 테스트
  - 게임 템플릿 적용 테스트

**예상 소요 시간**: 2-3시간

---

### **우선순위 3: 고급 기능 (선택사항)**

#### 5. 셀 서식 고도화
**현재 상태**: 기본 서식만 지원

**필요 작업**:
- [ ] 테두리 스타일 UI
  - 상/하/좌/우 개별 설정
  - 테두리 색상 선택
  - 테두리 두께 선택

- [ ] 폰트 크기 선택
- [ ] 셀 회전 (각도 조절)
- [ ] 들여쓰기 설정

**예상 소요 시간**: 4-5시간

---

#### 6. 더 많은 게임 템플릿
**현재 상태**: 기본 템플릿 9개

**추가 가능 템플릿**:
- [ ] Enemy Wave (적 웨이브 설정)
- [ ] Drop Table (아이템 드랍 테이블)
- [ ] Achievement (업적 시스템)
- [ ] Tutorial (튜토리얼 단계)
- [ ] Season Pass (시즌 패스 보상)
- [ ] Gacha Pool (가챠 확률표)

**예상 소요 시간**: 2-3시간

---

#### 7. E2E 테스트 (Playwright)
**현재 상태**: 기본 구조만 있음 (실패)

**필요 작업**:
- [ ] Playwright 설정 수정
  - 버전 충돌 해결
  - 설정 파일 정비

- [ ] 사용자 시나리오 테스트
  - 시트 생성 → 데이터 입력 → 저장
  - CSV Import → 편집 → Export
  - 찾기/바꾸기 사용
  - 복사/붙여넣기 사용

**예상 소요 시간**: 4-6시간

---

#### 8. 협업 편집 기능 (Collaborative Editing)
**현재 상태**: 구조만 정의됨, 미구현

**필요 작업**:
- [ ] Backend 서버 구축
  - Node.js + Socket.io
  - Yjs CRDT 라이브러리
  - Redis for presence

- [ ] Frontend 통합
  - CollaborationService 구현
  - 실시간 커서 표시
  - 충돌 해결 로직

- [ ] UI 추가
  - 접속 사용자 목록
  - 실시간 커서 색상
  - 변경 사항 동기화

**기술적 과제**:
- Backend 서버 필요
- CRDT 알고리즘 이해
- WebSocket 연결 관리
- 복잡도: 상

**예상 소요 시간**: 20-30시간

---

## 📅 구현 로드맵

### **Phase 1: 핵심 기능 완성** (2-3일)
1. ✅ ~~찾기/바꾸기~~ (완료)
2. ✅ ~~복사/붙여넣기~~ (완료)
3. ✅ ~~컬럼 이름 변경~~ (완료)
4. 🔄 **데이터 검증 UI** (진행 예정)
5. 🔄 **셀 병합 기능** (진행 예정)

### **Phase 2: 테스트 완성** (1-2일)
1. ✅ ~~Store 테스트~~ (완료)
2. 🔄 **SpreadsheetGrid 테스트**
3. 🔄 **Sidebar 테스트**

### **Phase 3: 고급 기능** (선택사항, 2-3일)
1. 셀 서식 고도화
2. 게임 템플릿 추가
3. E2E 테스트

### **Phase 4: 협업 기능** (선택사항, 1-2주)
1. Backend 서버 구축
2. Frontend 통합
3. 실시간 동기화 테스트

---

## 🎯 즉시 착수 가능한 작업 (우선순위 순)

### 1. 데이터 검증 UI (D4)
- 난이도: 중
- 예상 시간: 4-6시간
- 기존 Hook 활용 가능
- 즉시 가치 제공

### 2. SpreadsheetGrid 테스트 (E2)
- 난이도: 중
- 예상 시간: 3-4시간
- 기존 테스트 패턴 활용
- 코드 품질 향상

### 3. Sidebar 테스트 (E3)
- 난이도: 하
- 예상 시간: 2-3시간
- 간단한 UI 테스트
- 빠른 완성 가능

### 4. 셀 병합 기능 (D3)
- 난이도: 중-상
- 예상 시간: 6-8시간
- AG Grid 제약사항 고려 필요
- 복잡하지만 가치 높음

---

## 🔧 기술적 고려사항

### 셀 병합 구현 방식
```typescript
// Option 1: AG Grid 기본 기능 활용 (제한적)
// - spanHeaderHeight 사용
// - 복잡한 병합은 어려움

// Option 2: Custom Cell Renderer (추천)
// - 완전한 제어 가능
// - CSS Grid로 구현
// - 성능 최적화 필요

interface MergedCell {
  startRow: number;
  endRow: number;
  startColumn: number;
  endColumn: number;
  value: CellValue;
}
```

### 데이터 검증 UI 설계
```typescript
// ValidationPanel.tsx
interface ValidationPanelProps {
  sheetId: string;
  autoValidate?: boolean;  // 실시간 검증
}

// 검증 결과 표시
interface ValidationDisplay {
  type: 'error' | 'warning' | 'info';
  cellId: string;
  message: string;
  rule: string;
}
```

---

## 📊 예상 완성 시점

| 단계 | 작업 | 예상 시간 | 완성 예상일 |
|------|------|----------|-----------|
| Phase 1 | 데이터 검증 UI | 4-6시간 | D+1 |
| Phase 1 | 셀 병합 기능 | 6-8시간 | D+2 |
| Phase 2 | Grid 테스트 | 3-4시간 | D+2.5 |
| Phase 2 | Sidebar 테스트 | 2-3시간 | D+3 |

**전체 핵심 기능 완성**: 약 3일 소요 예상

---

## ✅ 체크리스트

### 즉시 착수 가능
- [ ] 데이터 검증 UI 구현
- [ ] SpreadsheetGrid 테스트 작성
- [ ] Sidebar 테스트 작성

### 중기 계획
- [ ] 셀 병합 기능 구현
- [ ] 셀 서식 고도화
- [ ] 게임 템플릿 추가

### 장기 계획
- [ ] E2E 테스트 구축
- [ ] 협업 기능 구현 (Backend 필요)

---

## 🎉 완료 시 달성 목표

### 기능 완성도
- ✅ 모든 핵심 UI 기능 구현
- ✅ 100% 테스트 커버리지 (컴포넌트)
- ✅ Production-ready 상태

### 코드 품질
- ✅ 타입 안정성 100%
- ✅ 단위 테스트 통과율 100%
- ✅ E2E 테스트 주요 시나리오 커버

### 사용자 경험
- ✅ 직관적인 UI/UX
- ✅ 실시간 피드백 (검증, 오류)
- ✅ 빠른 응답 시간

---

**다음 작업**: 데이터 검증 UI 구현부터 시작 권장
